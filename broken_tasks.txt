Here's a breakdown of the task and a guide to answering the questions about the highest-grossing films:

**1. Parameter Extraction**

*   `url`: The Wikipedia URL containing the data: `https://en.wikipedia.org/wiki/List_of_highest-grossing_films`
*   `target_year`: The year threshold for the first question: 2020
*   `threshold_2bn`: The gross revenue threshold for the first question: $2 billion
*   `threshold_1_5bn`: The gross revenue threshold for the second question: $1.5 billion

**2. Expected Output**

*   Question 1: JSON array of strings (e.g., `["2"]`)
*   Question 2: JSON array of strings (e.g., `["Avatar"]`)
*   Question 3: JSON array of strings with one floating-point number rounded to two decimal places. (e.g., `["0.85"]`)
*   Question 4: base-64 encoded data URI for a PNG image (e.g., `"data:image/png;base64,iVBORw0KG..."`)

**3. Step-by-step Guidance**

**Question 1: How many $2 bn movies were released before 2020?**

1.  **Scrape Data:** Access the table from the specified `url`. You'll need a library like `requests` (for fetching the HTML content) and `BeautifulSoup4` (for parsing and extracting data from the HTML).
2.  **Extract Relevant Columns:** Identify the columns for "Rank", "Title", "Worldwide gross", and "Year".
3.  **Filter Data:** Iterate through the data:
    *   Filter for films with a "Year" value before `target_year` (2020).
    *   Filter for films with a "Worldwide gross" value greater than or equal to `threshold_2bn` ($2 billion).  You'll likely need to clean the gross revenue data (remove currency symbols, commas, and convert to a numeric type).
4.  **Count and Format:** Count the number of films that meet both criteria. Convert the count to a string.
5.  **Output:** Return the count as a JSON array containing a string.

**Question 2: Which is the earliest film that grossed over $1.5 bn?**

1.  **Scrape Data:** Use the same scraping method as in Question 1.
2.  **Extract Relevant Columns:** Same as in Question 1.
3.  **Filter Data:**
    *   Filter for films with a "Worldwide gross" value greater than or equal to `threshold_1_5bn` ($1.5 billion).  Clean the data first as mentioned above.
4.  **Sort and Select:** Sort the filtered data by "Year" in ascending order. Select the film title with the earliest year.
5.  **Output:** Return the film title as a JSON array containing a string.

**Question 3: What's the correlation between the Rank and Peak?**

1.  **Scrape Data:** Use the same scraping method as in Question 1.
2.  **Extract Relevant Columns:** Extract columns for "Rank" and, if present, a column for "Peak", or approximate a reasonable value. Convert these columns to numerical data types. If a "Peak" column is missing, identify a proxy value that may be useful in the calculation.
3.  **Calculate Correlation:** Use a library like `NumPy` or `pandas` to compute the Pearson correlation coefficient between the "Rank" and the "Peak" values.
4.  **Format:** Round the correlation coefficient to two decimal places.
5.  **Output:** Return the correlation coefficient as a JSON array containing a string.

**Question 4: Draw a scatterplot of Rank and Peak along with a dotted red regression line through it.**

1.  **Scrape Data:** Use the same scraping method as in Question 1.
2.  **Extract Relevant Columns:** Extract the columns for "Rank" and "Peak" as numerical data.
3.  **Generate Scatterplot:**
    *   Use a library like `matplotlib` or `seaborn` to create a scatterplot with "Rank" on the x-axis and "Peak" on the y-axis.
4.  **Calculate Regression Line:**
    *   Use a library like `NumPy` or `scikit-learn` to perform linear regression on the "Rank" and "Peak" data.
    *   Calculate the parameters of the regression line (slope and intercept).
    *   Generate the points needed to plot the regression line across the data's range.
5.  **Plot Regression Line:** Plot the regression line on the scatterplot using a dotted red line style (e.g., `linestyle=':'`, `color='red'`).
6.  **Encode as Base64:** Use `matplotlib` or another image processing library to save the plot to an in-memory PNG image. Convert the image data to a base-64 encoded data URI using `base64` library. Ensure the final image is under the size constraints mentioned.
7.  **Output:** Return the base-64 encoded data URI string.
